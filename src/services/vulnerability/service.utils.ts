import { VulnerabilitySeverity } from "../../client/types.js";

export function extractOriginForVulnerability(href: string) {
  const originParts = href.split("/origins/");
  if (originParts.length > 1) {
    return originParts[1].split("/")[0];
  }
  return null;
}

const severityDueDateMap: Record<VulnerabilitySeverity, number> = {
  CRITICAL: 30,
  HIGH: 30,
  MEDIUM: 90,
  LOW: 120,
};

export function calculateDueDate(
  publishedDate: string,
  severity: VulnerabilitySeverity,
): string {
  const published = new Date(publishedDate);
  const daysToAdd = severityDueDateMap[severity] || 30;

  const dueDate = new Date(
    published.getTime() + daysToAdd * 24 * 60 * 60 * 1000,
  );
  return dueDate.toDateString();
}

export function isDateValid(dateString?: string): boolean {
  if (!dateString) {
    return false;
  }
  const date = new Date(dateString);
  return !isNaN(date.getTime());
}
